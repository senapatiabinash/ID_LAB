SELECT NAME, PHONE_NO, CUST_NO
FROM CUSTOMER
WHERE CUST_NO = (
SELECT CUST_NO
FROM DEPOSITOR
WHERE ACCOUNT_NO = 'A0004'
);



SELECT NAME
FROM CUSTOMER
WHERE CUST_NO NOT IN (
SELECT DISTINCT CUST_NO
FROM LOAN
);



SELECT DISTINCT b.BRANCH_CITY
FROM CUSTOMER c
JOIN LOAN l ON c.CUST_NO = l.CUST_NO
JOIN BRANCH b ON l.BRANCH_CODE = b.BRANCH_CODE
WHERE c.NAME = 'ASLESHA TIWARI';


SELECT INST_NO, INST_AMOUNT
FROM INSTALLMENT
WHERE LOAN_NO IN (
SELECT LOAN_NO
FROM LOAN
WHERE CUST_NO = (
SELECT CUST_NO
FROM CUSTOMER
WHERE NAME = 'ANKITA SINGH'
)
);



SELECT BRANCH_NAME, BRANCH_CITY
FROM BRANCH
WHERE BRANCH_CODE IN (
SELECT BRANCH_CODE
FROM ACCOUNT
WHERE ACCOUNT_NO IN (
SELECT ACCOUNT_NO
FROM DEPOSITOR
WHERE CUST_NO = (
SELECT CUST_NO
FROM CUSTOMER
WHERE NAME = 'ABHIJIT MISHRA'
)
)
);



SELECT ACCOUNT_NO
FROM ACCOUNT
WHERE BALANCE > SOME (
SELECT BALANCE
FROM ACCOUNT
WHERE TYPE = 'FD'
);



SELECT ACCOUNT_NO
FROM ACCOUNT
WHERE BALANCE > ALL (
SELECT BALANCE
FROM ACCOUNT
WHERE TYPE = 'FD'
);



SELECT *
FROM BRANCH
WHERE EXISTS (
SELECT 1
FROM LOAN
WHERE LOAN.BRANCH_CODE = BRANCH.BRANCH_CODE
);



SELECT *
FROM LOAN
WHERE NOT EXISTS (
SELECT 1
FROM INSTALLMENT
WHERE INSTALLMENT.LOAN_NO = LOAN.LOAN_NO
);



SELECT DISTINCT L.LOAN_NO
FROM LOAN L
JOIN BRANCH B ON L.BRANCH_CODE = B.BRANCH_CODE
WHERE B.BRANCH_CITY = 'MUMBAI';



SELECT DISTINCT A.TYPE
FROM ACCOUNT A
JOIN BRANCH B ON A.BRANCH_CODE = B.BRANCH_CODE
WHERE B.BRANCH_CITY = 'DELHI';



SELECT DISTINCT C.NAME, C.PHONE_NO
FROM CUSTOMER C
JOIN DEPOSITOR D ON C.CUST_NO = D.CUST_NO
JOIN ACCOUNT A ON D.ACCOUNT_NO = A.ACCOUNT_NO
WHERE A.BALANCE > 100000;


SELECT I.INST_NO, I.INST_AMOUNT
FROM INSTALLMENT I
JOIN LOAN L ON I.LOAN_NO = L.LOAN_NO
JOIN CUSTOMER C ON L.CUST_NO = C.CUST_NO
WHERE C.NAME = 'RAJ ANAND SINGH';



SELECT DISTINCT C.NAME
FROM CUSTOMER C
LEFT JOIN DEPOSITOR D ON C.CUST_NO = D.CUST_NO
LEFT JOIN ACCOUNT A ON D.ACCOUNT_NO = A.ACCOUNT_NO AND A.TYPE = 'SB'
WHERE A.ACCOUNT_NO IS NULL;



SELECT DISTINCT C.NAME
FROM CUSTOMER C
JOIN LOAN L ON C.CUST_NO = L.CUST_NO
JOIN INSTALLMENT I ON L.LOAN_NO = I.LOAN_NO
WHERE I.INST_AMOUNT = 50000;



SELECT DISTINCT C.PHONE_NO
FROM CUSTOMER C
JOIN DEPOSITOR D ON C.CUST_NO = D.CUST_NO
JOIN ACCOUNT A ON D.ACCOUNT_NO = A.ACCOUNT_NO
JOIN BRANCH B ON A.BRANCH_CODE = B.BRANCH_CODE
WHERE B.BRANCH_NAME = 'SALTLAKE BRANCH';



SELECT B.BRANCH_NAME, B.BRANCH_CITY
FROM BRANCH B
JOIN ACCOUNT A ON B.BRANCH_CODE = A.BRANCH_CODE
JOIN DEPOSITOR D ON A.ACCOUNT_NO = D.ACCOUNT_NO
JOIN CUSTOMER C ON D.CUST_NO = C.CUST_NO
WHERE C.NAME = 'ABHIJIT MISHRA';



SELECT A.TYPE, A.BALANCE
FROM ACCOUNT A
JOIN DEPOSITOR D ON A.ACCOUNT_NO = D.ACCOUNT_NO
JOIN CUSTOMER C ON D.CUST_NO = C.CUST_NO
WHERE C.NAME = 'SWAROOP RAY'


WITH TotalBalances AS (
SELECT BRANCH_CODE, SUM(BALANCE) AS TotalBalance
FROM ACCOUNT
GROUP BY BRANCH_CODE
)



SELECT BRANCH_CODE
FROM TotalBalances
WHERE TotalBalance > (SELECT AVG(TotalBalance) FROM TotalBalances);
